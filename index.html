<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toggl - Time Tracking</title>
    <link rel="stylesheet" href="styles.css">
    <script type="importmap">
    {
        "imports": {
            "vue": "https://unpkg.com/vue@3/dist/vue.esm-browser.js"
        }
    }
    </script>
</head>
<body>
    <div id="app">
        <button class="toggle-sidebar" :class="{ active: !sidebarVisible }" @click="toggleSidebar">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M15 18l-6-6 6-6" />
            </svg>
        </button>
        <div class="dashboard" :class="{ 'sidebar-hidden': !sidebarVisible }">
            <aside class="sidebar" :class="{ hidden: !sidebarVisible }">
                <div class="logo">
                    <h1>Toggl</h1>
                </div>
                <div class="mini-calendar-header">
                    <button @click="previousMonth">&lt;</button>
                    <span>{{ currentMonthDisplay }}</span>
                    <button @click="nextMonth">&gt;</button>
                </div>
                <table class="mini-calendar">
                    <thead>
                        <tr>
                            <th>Di</th>
                            <th>Lu</th>
                            <th>Ma</th>
                            <th>Me</th>
                            <th>Je</th>
                            <th>Ve</th>
                            <th>Sa</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="week in Math.ceil(miniCalendarDays.length / 7)">
                            <td v-for="i in 7" 
                                :class="{
                                    'today': isToday(miniCalendarDays[(week-1)*7 + i-1]),
                                    'selected': isSelected(miniCalendarDays[(week-1)*7 + i-1]),
                                    'other-month': miniCalendarDays[(week-1)*7 + i-1] && !miniCalendarDays[(week-1)*7 + i-1].isCurrentMonth,
                                    'has-activities': hasActivities(miniCalendarDays[(week-1)*7 + i-1])
                                }"
                                @click="selectDate(miniCalendarDays[(week-1)*7 + i-1])">
                                {{ miniCalendarDays[(week-1)*7 + i-1]?.date.getDate() || '' }}
                            </td>
                        </tr>
                    </tbody>
                </table>
                <div class="project-list">
                    <h3>Projects</h3>
                    <ul>
                        <li v-for="project in projects" 
                            :class="{ active: selectedProject === project.id }"
                            @click="selectProject(project.id)">
                            <span class="project-color" :style="{ backgroundColor: project.color }"></span>
                            {{ project.name }}
                        </li>
                    </ul>
                </div>
            </aside>

            <main class="main-content">
                <div class="calendar-header">
                    <button @click="previousWeek">&lt;</button>
                    <h2>{{ currentWeekDisplay }}</h2>
                    <button @click="nextWeek">&gt;</button>
                </div>

                <div class="timer-container">
                    <div class="timer-display">
                        <div class="description-input">
                            <input v-model="currentActivity.description" placeholder="What are you working on?" />
                        </div>
                        <div class="project-selector">
                            <select v-model="currentActivity.projectId">
                                <option value="">Select project</option>
                                <option v-for="project in projects" :value="project.id">{{ project.name }}</option>
                            </select>
                        </div>
                        <div class="timer">
                            <span class="time">{{ formatTime(elapsedTime) }}</span>
                            <button v-if="!timerRunning" @click="startTimer" class="start-button">Start</button>
                            <button v-else @click="stopTimer" class="stop-button">Stop</button>
                        </div>
                    </div>
                </div>

                <div class="activity-list">
                    <h3>Today's Activities</h3>
                    <div class="activities">
                        <div v-for="activity in todayActivities" class="activity-item">
                            <div class="activity-details">
                                <div class="activity-description">{{ activity.description }}</div>
                                <div class="activity-project" :style="{ color: getProjectColor(activity.projectId) }">
                                    {{ getProjectName(activity.projectId) }}
                                </div>
                            </div>
                            <div class="activity-time">
                                <span>{{ formatTime(activity.duration) }}</span>
                                <button @click="continueActivity(activity)" class="continue-button">Continue</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calendar-view">
                    <div class="time-column">
                        <div v-for="hour in hours" class="time-slot">{{ hour }}:00</div>
                    </div>
                    <div class="days-grid">
                        <div v-for="day in currentWeek" 
                             class="day-column"
                             :class="{ 'selected': isDaySelected(day) }">
                            <div class="day-header" :class="{ 'selected': isDaySelected(day) }">
                                {{ formatDay(day) }}
                            </div>
                            <div class="activities-container">
                                <div v-for="activity in getActivitiesForDay(day)" 
                                     :class="['activity-block']"
                                     :style="getActivityStyle(activity)"
                                     @click="openActivityDetails(activity)">
                                    <p class="time">{{ formatTimeRange(activity) }}</p>
                                    <p class="activity-info">{{ activity.description }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
        <div class="modal-overlay" :class="{ active: showModal }" @click.self="closeModal">
            <div class="modal-content">
                <button class="modal-close" @click="closeModal">Ã—</button>
                <div class="modal-header">
                    <h2>Activity Details</h2>
                </div>
                <div v-if="selectedActivity">
                    <div class="activity-detail">
                        <span class="detail-label">Description:</span>
                        <span class="detail-value">{{ selectedActivity.description }}</span>
                    </div>
                    <div class="activity-detail">
                        <span class="detail-label">Project:</span>
                        <span class="detail-value" :style="{ color: getProjectColor(selectedActivity.projectId) }">
                            {{ getProjectName(selectedActivity.projectId) }}
                        </span>
                    </div>
                    <div class="activity-detail">
                        <span class="detail-label">Start Time:</span>
                        <span class="detail-value">{{ formatDateTime(selectedActivity.startTime) }}</span>
                    </div>
                    <div class="activity-detail">
                        <span class="detail-label">End Time:</span>
                        <span class="detail-value">{{ formatDateTime(selectedActivity.endTime) }}</span>
                    </div>
                    <div class="activity-detail">
                        <span class="detail-label">Duration:</span>
                        <span class="detail-value">{{ formatTime(selectedActivity.duration) }}</span>
                    </div>
                    <div class="activity-actions">
                        <button class="action-button continue-button" @click="continueActivity(selectedActivity)">
                            Continue
                        </button>
                        <button class="action-button delete-button" @click="deleteActivity(selectedActivity)">
                            Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="module" src="main.js"></script>
</body>
</html>